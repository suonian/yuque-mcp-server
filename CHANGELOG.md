# 更新日志

所有重要的项目变更都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

---

## [1.2.2] - 2025-11-29

### ✨ 新增功能

- **一键安装脚本**
  - 实现了`install.py`一键安装脚本，支持Windows、macOS和Linux
  - 自动检测操作系统，安装依赖并创建配置文件
  - 支持服务安装和验证安装结果

- **项目结构优化**
  - 符合GitHub发布标准
  - 清晰的文件组织结构
  - 完整的README文档
  - 适当的许可证文件

### 🔧 改进

- **依赖管理**
  - 优化了依赖关系，移除了冗余依赖
  - 更新了过时组件至安全稳定版本
  - 确保跨平台兼容性

- **文档更新**
  - 更新了所有文档，确保内容完整准确
  - 添加了AUTO_START_GUIDE.md自动启动指南
  - 更新了DOCKER_DEPLOYMENT.md Docker部署指南
  - 更新了WINDOWS_DEPLOYMENT.md Windows部署指南

- **启动脚本增强**
  - 支持三种启动模式：异步、同步、自动
  - 增强了命令行选项
  - 改进了日志管理

### 🐛 修复

- 修复了GitHub Actions测试配置
- 修复了各种bug和配置问题
- 修复了Windows部署指南中的脚本路径错误
- 修复了Dockerfile中的脚本路径错误

## [1.1.0] - 2025-11-20

### ✨ 新增功能

- **增强文档查询功能**
  - `get_doc` 工具现在自动获取并显示知识库归属信息
  - 文档返回包含完整的元数据（创建者、阅读数、点赞数、评论数等）
  - 显示完整的访问路径和使用方法

- **改进搜索结果展示**
  - 修复搜索API数据结构解析问题，正确提取 namespace 和 slug
  - 搜索结果中直接显示完整路径和使用方法
  - 显示文档统计信息（阅读数、点赞数）
  - 处理信息缺失情况，提供友好的提示和替代方案

- **新增 `get_doc_by_id` 工具**
  - 提供友好的错误提示和使用建议
  - 明确说明语雀API的限制

### 🔧 改进

- **错误处理增强**
  - 实现标准化的 MCP 错误码扩展（-32001 到 -32009）
  - 根据HTTP状态码返回明确的错误码和解决建议
  - 增强日志记录，包含详细的调试信息

- **文档内容获取优化**
  - 添加内容完整性检测（完整内容/仅预览）
  - 当权限不足时提供明确的提示和解决建议
  - 显示内容长度信息

### 🐛 修复

- **修复搜索功能数据结构解析**
  - 修复从语雀搜索API返回数据中提取 namespace 和 slug 的问题
  - 正确解析 `target` 字段中的文档和知识库信息

- **修复搜索结果展示**
  - 修复知识库信息显示为"未知"的问题
  - 修复无法获取完整路径的问题

### 📚 文档

- 新增 `ENHANCEMENT_SUMMARY.md` - 功能增强总结
- 新增 `ISSUE_ANALYSIS.md` - 问题分析文档
- 新增 `SOLUTION_SUMMARY.md` - 解决方案总结
- 更新 `README.md` - 添加最新功能说明

---

## [1.0.0] - 2025-11-19

### 🎉 首次发布

- 完整的 MCP 协议实现（2024-11-05）
- 支持 29+ 个语雀 API 工具
- Docker 部署支持
- 跨平台支持（macOS/Linux/Windows）
- 完整的文档和测试脚本

### ✨ 核心功能

- 用户管理：获取用户信息
- 知识库管理：完整的 CRUD 操作
- 文档管理：完整的 CRUD 操作、版本历史
- 搜索功能：全文搜索
- 团队管理：团队信息、成员管理、统计功能

### 🔐 安全特性

- 支持 HTTP Header 和环境变量配置 Token
- 配置文件已添加到 `.gitignore`
- 无硬编码敏感信息

### 📦 部署支持

- Docker 一键部署
- 跨平台启动脚本（macOS/Linux/Windows）
- 系统服务自动启动（macOS launchd）
- 自动化测试脚本

---

## [1.2.1] - 2025-11-29

### ✨ 新增功能

- **缓存机制实现**
  - 支持 Redis 和内存缓存两种模式
  - 为不同类型的 API 请求设置不同的过期时间
  - 自动降级机制，Redis 不可用时自动切换到内存缓存
  - 缓存统计功能，支持查看命中次数和命中率

- **异步框架集成**
  - 使用 FastAPI 和 httpx 实现异步 API 调用
  - 创建了异步版本的 API 客户端 `async_yuque_client.py`
  - 支持异步 Web 服务 `app_async.py`
  - 提高了系统的并发处理能力和响应速度

- **自动启动功能**
  - 实现了自动启动包装器 `auto_start_server.py`
  - 支持系统服务自动启动
  - 智能检测服务状态，按需启动
  - 支持多种启动模式：启动脚本、系统服务、自动启动包装器

### 🔧 改进

- **项目结构优化**
  - 符合 GitHub 发布标准
  - 清晰的文件组织结构
  - 完整的 README 文档
  - 适当的许可证文件

- **文档更新**
  - 更新了所有文档，确保内容完整准确
  - 添加了 AUTO_START_GUIDE.md 自动启动指南
  - 更新了 DOCKER_DEPLOYMENT.md Docker 部署指南
  - 更新了 WINDOWS_DEPLOYMENT.md Windows 部署指南

- **启动脚本增强**
  - 支持三种启动模式：异步、同步、自动
  - 增强了命令行选项
  - 改进了日志管理

### 🐛 修复

- 修复了 GitHub Actions 测试配置
- 修复了各种 bug 和配置问题
- 修复了 Windows 部署指南中的脚本路径错误
- 修复了 Dockerfile 中的脚本路径错误

### 📦 依赖更新

- 添加了 fastapi>=0.100.0
- 添加了 uvicorn>=0.22.0
- 添加了 httpx>=0.24.0
- 添加了 redis>=5.0.0

## [未发布]

### 计划功能

- [ ] 支持更多语雀 API 功能
- [ ] 添加 Webhook 支持
- [ ] 性能优化
- [ ] 更多客户端兼容性测试
- [ ] CI/CD 自动化

---

**注意**: 版本号格式为 `主版本号.次版本号.修订号`

- **主版本号**: 不兼容的 API 修改
- **次版本号**: 向下兼容的功能性新增
- **修订号**: 向下兼容的问题修正

